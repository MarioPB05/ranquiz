{% load cloudinary %}
{% load static %}
<div id="kt_header" class="header align-items-stretch">
    <!--begin::Container-->
    <div class="container-fluid d-flex align-items-stretch justify-content-between ps-0" style="background-color: #BD20E9;box-shadow: 0 4px 4px rgba(0, 0, 0, 0.25);">

        <!--begin::Mobile logo-->
        <div class="d-flex align-items-center flex-grow-1 flex-lg-grow-0 bg-white">
            <a class="mb-0" href="{% url 'homepage' %}">
                <img alt="Logo" src="{% static 'assets/media/logo/ranquiz.png' %}" class="h-50px p-2 px-6" />
            </a>
        </div>
        <!--end::Mobile logo-->

        <!--begin::Wrapper-->
        <div class="d-flex align-items-stretch flex-lg-grow-1 w-100">
            <!--begin::Navbar-->
            <div class="d-flex align-items-stretch w-100" id="kt_header_nav">
                <!--begin::Menu wrapper-->
                <div class="header-menu align-items-stretch w-100" data-kt-drawer="true"
                     data-kt-drawer-name="header-menu" data-kt-drawer-activate="{default: true, lg: false}"
                     data-kt-swapper-parent="{default: '#kt_body', lg: '#kt_header_nav'}">
                    <!--begin::Menu-->
                    <div class="menu menu-lg-rounded menu-column menu-lg-row menu-state-bg-light-primary menu-title-white
                    menu-state-title-info menu-icon-white menu-state-icon-primary fw-bold my-5 my-lg-0 align-items-stretch ps-6 gap-4"
                         id="#kt_header_menu" data-kt-menu="true">
                        <div class="menu-item menu-lg-down-accordion me-lg-1">
                            <a href="{% url 'homepage' %}" class="menu-link scroll-btn align-items-start py-3">
                                <span class="menu-icon">
                                    <i class="bi bi-house-fill fs-2"></i>
                                </span>
                                <span class="menu-title fw-bolder">Inicio</span>
                            </a>
                        </div>

                        <div class="menu-item menu-lg-down-accordion me-lg-1">
                            <a href="#" class="menu-link scroll-btn align-items-start py-3">
                                <span class="menu-icon">
                                    <i class="bi bi-award-fill fs-2"></i>
                                </span>
                                <span class="menu-title fw-bolder">Misiones</span>
                            </a>
                        </div>

                        <div class="menu-item menu-lg-down-accordion me-lg-1">
                            <a href="{% url 'shop' %}" class="menu-link scroll-btn py-3">
                                <span class="menu-icon">
                                    <i class="bi bi-bag-fill fs-3"></i>
                                </span>
                                <span class="menu-title fw-bolder">Tienda</span>
                            </a>
                        </div>
                    </div>
                    <!--end::Menu-->
                </div>
                <!--end::Menu wrapper-->
            </div>
            <!--end::Navbar-->

            <!--begin::Toolbar wrapper-->
            <div class="d-flex align-items-center ms-1 ms-lg-3">
                {% if user.is_authenticated %}
                    <a class="btn btn-icon btn-icon-muted btn-active-light btn-active-color-primary px-2 w-auto h-30px h-md-40px text-white text-hover-primary me-4">
                        <i class="bi bi-gem fs-2 text-white"></i>
                        <span class="fw-bolder ms-2 user_money">{{ user.money }}</span>
                    </a>

                    <a class="btn btn-icon btn-icon-muted btn-active-light btn-active-color-primary w-30px h-30px w-md-40px h-md-40px text-hover-primary me-4" href="#">
                        <i class="bi bi-envelope fs-2x text-white"></i>
                    </a>
                {% endif %}

                <!--begin::Menu wrapper-->
                <div class="cursor-pointer symbol symbol-30px symbol-md-40px user-avatar" data-kt-menu-trigger="click" data-kt-menu-attach=".{% if user.is_authenticated %}user_avatar{% else %}user-avatar{% endif %}" data-kt-menu-placement="bottom-end" data-kt-menu-offset="0,05">
                    <div class="symbol symbol-30px symbol-md-40px symbol-circle">
                        {% if user.is_authenticated %}
                            {% cloudinary user.avatar.image class="user_avatar" %}
                        {% else %}
                            <i class="bi bi-person-circle text-white fs-2qx user-avatar"></i>
                        {% endif %}
                    </div>
                </div>

                <!--begin::User account menu-->
                <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-800 menu-state-bg menu-state-primary fw-bold py-4 fs-6 w-275px" data-kt-menu="true">
                    <!--begin::Menu item-->
                    <div class="menu-item px-3">
                        <div class="menu-content d-flex align-items-center px-3">
                            {% if user.is_authenticated %}
                                <!--begin::Avatar-->
                                <div class="symbol symbol-75px me-5">
                                    {% cloudinary user.avatar.image class="user_avatar" %}
                                </div>
                                <!--end::Avatar-->

                                <!--begin::Username-->
                                <div class="d-flex flex-column">
                                    <div class="fw-bolder d-flex align-items-center fs-5 text-nowrap">{{ user.username }}</div>

                                    <div class="d-inline fs-8 mt-1 ps-0 badge badge-light-primary">Gemas: <span class="user_money">{{ user.money }}</span></div>
                                </div>
                                <!--end::Username-->
                            {% else %}
                                <div class="d-flex flex-column gap-2 w-100">
                                    <a href="{% url 'login' %}" class="btn btn-primary fw-bolder w-100">Iniciar Sesión</a>
                                    <a href="{% url 'register' %}" class="btn btn-outline btn-outline-primary btn-active-primary fw-bolder w-100">Registrarse</a>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    <!--end::Menu item-->

                    {% if user.is_authenticated %}
                        <!--begin::Menu separator-->
                        <div class="separator my-2"></div>
                        <!--end::Menu separator-->

                        <!--begin::Menu item-->
                        <div class="menu-item px-5">
                            <a href="{% url 'homepage' %}" class="menu-link px-5">
                                <span class="menu-icon">
                                    <i class="bi bi-house fs-3"></i>
                                </span>
                                Inicio
                            </a>
                        </div>
                        <!--end::Menu item-->

                        <!--begin::Menu item-->
                        <div class="menu-item px-5">
                            <a href="{% url 'user' share_code=user.share_code %}" class="menu-link px-5">
                                <span class="menu-icon">
                                    <i class="bi bi-person-circle"></i>
                                </span>
                                Perfil
                            </a>
                        </div>
                        <!--end::Menu item-->

                        <!--begin::Menu item-->
                        <div class="menu-item px-5">
                            <a href="{% url 'user' share_code=user.share_code %}?card=settings" class="menu-link px-5">
                                <span class="menu-icon">
                                    <i class="bi bi-gear"></i>
                                </span>
                                Ajustes
                            </a>
                        </div>
                        <!--end::Menu item-->

                        <!--begin::Menu item-->
                        <div class="menu-item text-hover-danger px-5">
                            <a href="{% url 'logout' %}" class="menu-link px-5" style="color:inherit;">
                                <span class="menu-icon">
                                    <i class="bi bi-box-arrow-left"></i>
                                </span>
                                Cerrar Sesión
                            </a>
                        </div>
                        <!--end::Menu item-->
                    {% endif %}
                </div>
                <!--end::User account menu-->
                <!--end::Menu wrapper-->
            </div>
            <!--end::Toolbar wrapper-->
        </div>
        <!--end::Wrapper-->
    </div>
    <!--end::Container-->
</div>